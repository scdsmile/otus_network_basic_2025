# Лабораторная работа 3 - Расчёт подсетей IPv4

## Задачи
1. Определение подсетей по IPv4-адресу

2. Расчет подсетей по IPv4-адресу

## Общие сведения/сценарий

Умение работать с IPv4-подсетями и определять информацию о сетях и узлах на основе известного IP-адреса и маски подсети необходимо для понимания принципов работы IPv4-сетей. Цель первой части — закрепить знания о том, как рассчитывать IP-адрес сети на основе известного IP-адреса и маски подсети. Зная IP-адрес и маску подсети, вы всегда сможете получить другие данные об этой подсети.

## Задание №1

### Дано:
|                 Параметр |         Значение |
| ------------------------ | ---------------- |
|          IP-адрес узла:  | 192.168.200.139  |
| Исходная маска подсети:  | 255.255.255.0    |
|    Новая маска подсети:  | 255.255.255.224  |
	
### Переведём маски в двоичный вид и посчитаем длину масок.

Используем для перевода четвертого октета новой маски 8-битную таблицу степеней двойки, разложим на ней число 224.
> Остальные 3 октета, очевидно, заполнены единицами, так как 255 – это максимально возможное 8-битное число.

| 128 | 64 | 32 | 16 | 8 | 4 | 2 | 1 |
| --- | -- | -- | -- | - | - | - | - |
|   1 |	 1 |  1 |  0 | 0 | 0 | 0 | 0 |	

В итоге имеем:

|                 |               Двоичное представление | Количество бит |
| --------------- | ------------------------------------ | -------------- |
| Исходная маска  | 11111111.11111111.11111111.00000000  |            /24 |
|    Новая маска  | 11111111.11111111.11111111.11100000  |            /27 |

Как мы видим из двоичного представления, в четвертом октете мы на подсеть «отнимаем» **3 бита**, оставшиеся **5 бит** – узловая часть.

> Также можно руководствоваться битовой длиной масок:
> 
> Количество бит подсети: $$27-24=3$$
> 
> Количество бит узлов: $$32-27=5$$

### Вычислим количество подсетей и узлов

Количество возможных созданных подсетей мы вычисляем возведением 2 в степень количества битов подсети: $$2^3 = 8$$

Количество узлов в подсети вычисляем возведением 2 в степень количества битов узлов: $$2^5-2 = 32-2 = 30$$

> При подсчёте количества узлов вычитаем 2 адреса – адрес сети и широковещательный адрес.

### Определим сетевой адрес подсети:

Для этого возьмём адрес узла $$192.168.200.139$$ и переведём его к двоичному представлению.

> Первые три октета можно вообще не трогать, так как по исходной маске они, очевидно, фиксированы, но для закрепления материала переведем все.

192:

| 128 | 64 | 32 | 16 | 8 | 4 | 2 | 1 |
| --- | -- | -- | -- | - | - | - | - |
|   1 |	 1 |  0 |  0 | 0 | 0 | 0 | 0 |

168:

| 128 | 64 | 32 | 16 | 8 | 4 | 2 | 1 |
| --- | -- | -- | -- | - | - | - | - |
|   1 |	 0 |  1 |  0 | 1 | 0 | 0 | 0 |

200:

| 128 | 64 | 32 | 16 | 8 | 4 | 2 | 1 |
| --- | -- | -- | -- | - | - | - | - |
|   1 |	 1 |  0 |  0 | 1 | 0 | 0 | 0 |

139:

| 128 | 64 | 32 | 16 | 8 | 4 | 2 | 1 |
| --- | -- | -- | -- | - | - | - | - |
|   1 |	 0 |  0 |  0 | 1 | 0 | 1 | 1 |

Результат: $$192.168.200.139 → 11000000.10101000.11001000.10001011$$

Для вычисления адреса сети оставим в узловой части нули: $$11000000.10101000.11001000.10000000$$

И переведём последний октет в десятичную систему:

| 128 | 64 | 32 | 16 | 8 | 4 | 2 | 1 |
| --- | -- | -- | -- | - | - | - | - |
|   1 |	 0 |  0 |  0 | 0 | 0 | 0 | 0 |

Итого имеем адрес подсети $$192.168.200.128$$

### Вычислим адреса первого и последнего узлов, а также широковещательный:

Адрес первого узла – это адрес сети + 1, соответственно получаем $$192.168.200.129$$

Адрес последнего узла найдём исходя из того, что мы уже посчитали количество узлов (30), прибавим их к адресу сети, получаем $$192.168.200.158$$

Ну и широковещательный адрес можем вычислить либо прибавив к адресу сети 32 ($$2^5=32$$ или $$00011111 = 32$$), тем самым узнаем адрес следующей подсети ($$192.168.200.160$$) и отнимем 1, либо просто возьмём следующий адрес после адреса последнего узла, в любом случае получаем $$192.168.200.159$$

> В этом задании мы работаем с одним октетом и малым количеством адресов, поэтому я изначально посчитал довольно криво, как подсказывала логика.
>
> На самом деле удобнее сначала вычислить широковещательный адрес, а уже потом адрес последнего узла.
> 
> Во время выполнения второго задания я вспомнил, что в широковещательном адресе вся узловая часть заполнена единицами. Это несколько упрощает процесс:
>
> Берём наш адрес $$11000000.10101000.11001000.10001011$$ и забиваем последние 5 бит единицами: $$11000000.10101000.11001000.10011111$$
>
> Получаем тот же адрес $$192.168.200.159$$, отталкиваясь от которого уже проще выяснить адрес последнего узла подсети: $$192.168.200.159 - 1 = 192.168.200.158$$

### Итог:

|                                         Параметр |         Значение |
| ------------------------------------------------ | ---------------- |
|                         Количество бит подсети:  |                3 |
|                  Количество созданных подсетей:  |                8 |
|                 Количество бит узлов в подсети:  |                5 |
|                     Количество узлов в подсети:  |               30 |
|                     Сетевой адрес этой подсети:  |  192.168.200.128 |
|         IPv4-адрес первого узла в этой подсети:  |  192.168.200.129 |
|      IPv4-адрес последнего узла в этой подсети:  |  192.168.200.159 |
|    Широковещательный IPv4-адрес в этой подсети:  |  192.168.200.160 |

_________________________


## Задание №2

### Дано:
|                 Параметр |         Значение |
| ------------------------ | ---------------- |
|          IP-адрес узла:  |   10.101.99.228  |
| Исходная маска подсети:  |     255.0.0.0    |
|    Новая маска подсети:  |   255.255.128.0  |


Чтобы быстрее ориентироваться в масках подсетей, я запомнил 8 возможных десятичных значений одного октета:

|     |    |
| --- | -- |
|   128 |	 1 бит |
|   192 |	 2 бит |
|   224 |	 3 бит |
|   240 |	 4 бит |
|   248 |	 5 бит |
|   252 |	 6 бит |
|   254 |	 7 бит |
|   255 |	 8 бит |

Запомнив эти значения, становится проще в уме и считать битовую длину маски подсети, и переводить маску в двоичный вид. Например, в данном случае:

Исходная маска: $$255.0.0.0 → 8 + 0 + 0 + 0 → /8 → 11111111.00000000.00000000.00000000$$

Новая маска: $$255.255.128.0 → 8 + 8 + 1 + 0 → /17 → 11111111.11111111.10000000.00000000$$

Получается быстрее, чем каждый октет раскладывать по таблице степеней двойки.

### Посчитаем количество бит подсети и узлов, используя только битовую длину:

Количество бит подсети: $$/17 - /8 = 9$$

Количество бит узлов: $$/32 - /17 = 15$$

### Считаем количество подсетей и узлов:

Количество созданных подсетей: $$2^9 = 512$$

Количество узлов в подсети: $$2^{15} = 32768 – 2 = 32766$$

> Не забываем вычитать 2 адреса - адрес сети и бродкаст.

От использования таблицы степеней двойки пока всё равно не уйти, используем её для приведения исходного ip-адреса $$10.101.99.228$$ к двоичному виду:

10:

| 128 | 64 | 32 | 16 | 8 | 4 | 2 | 1 |
| --- | -- | -- | -- | - | - | - | - |
|   0 |	 0 |  0 |  0 | 1 | 0 | 1 | 0 |

101:

| 128 | 64 | 32 | 16 | 8 | 4 | 2 | 1 |
| --- | -- | -- | -- | - | - | - | - |
|   0 |	 1 |  1 |  0 | 0 | 1 | 0 | 1 |

99:

| 128 | 64 | 32 | 16 | 8 | 4 | 2 | 1 |
| --- | -- | -- | -- | - | - | - | - |
|   0 |	 1 |  1 |  0 | 0 | 0 | 1 | 1 |

228:

| 128 | 64 | 32 | 16 | 8 | 4 | 2 | 1 |
| --- | -- | -- | -- | - | - | - | - |
|   1 |	 1 |  1 |  0 | 0 | 1 | 0 | 0 |

В итоге $10.101.99.228 → 00001010.01100101.01100011.11100100$

### Вычислим адрес сети

Для этого наложим нашу новую маску на заданный адрес и забьём узловую часть нулями. 

> Для лучшего понимания того, как это работает: мы побитово используем логическую операцию **AND** (1 - если оба бита равны 1; 0 - во всех остальных случаях):

|            | Октет 1         | Октет 2         | Октет 3         | Октет 4         |
|------------|-----------------|-----------------|-----------------|-----------------|
|   ip-адрес | 0 0 0 0 1 0 1 0 | 0 1 1 0 0 1 0 1 | 0 1 1 0 0 0 1 1 | 1 1 1 0 0 1 0 0 |
| новая маска| 1 1 1 1 1 1 1 1 | 1 1 1 1 1 1 1 1 | 1 0 0 0 0 0 0 0 | 0 0 0 0 0 0 0 0 |
| адрес сети | 0 0 0 0 1 0 1 0 | 0 1 1 0 0 1 0 1 | 0 0 0 0 0 0 0 0 | 0 0 0 0 0 0 0 0 |


3й и 4й октеты заполнены нулями, а первые два мы и так знаем из адреса, получается адрес сети – 10.101.0.0

> В целом, опять же, смотря на маску, можно понять, что нам можно не трогать 1й и 2й октеты, так как при выполнении операции **AND** мы получим изначальное значение, ведь оба октета забиты единицами, так что можно начинать с того октета, на который «залазит» наша маска подсети:

| Октет 3         | Октет 4         |
|-----------------|-----------------|
| 0 1 1 0 0 0 1 1 | 1 1 1 0 0 1 0 0 |
| 1 0 0 0 0 0 0 0 | 0 0 0 0 0 0 0 0 |
| 0 0 0 0 0 0 0 0 | 0 0 0 0 0 0 0 0 |

Найдём адрес первого узла, помним, что это адрес сети + 1, получаем: $$10.101.0.1$$

Теперь найдём широковещательный адрес (бродкаст). Бродкаст подразумевает узловую часть, заполненную единицами, в нашем случае 01111111.11111111, то есть 127.255, соответственно бродкаст адрес для этой подсети: $$10.101.127.255$$

Теперь можно отнять от бродкаста 1 адрес и получить адрес последнего узла подсети: $$10.101.127.254$$

### Итог:

|                                         Параметр |         Значение |
| ------------------------------------------------ | ---------------- |
|                         Количество бит подсети:  |                9 |
|                  Количество созданных подсетей:  |              512 |
|                 Количество бит узлов в подсети:  |               15 |
|                     Количество узлов в подсети:  |            32766 |
|                     Сетевой адрес этой подсети:  |       10.101.0.0 |
|         IPv4-адрес первого узла в этой подсети:  |       10.101.0.1 |
|      IPv4-адрес последнего узла в этой подсети:  |   10.101.127.254 |
|    Широковещательный IPv4-адрес в этой подсети:  |   10.101.127.255 |

____________

## Задание №3

### Дано:
|                 Параметр |         Значение |
| ------------------------ | ---------------- |
|          IP-адрес узла:  |    172.22.32.12  |
| Исходная маска подсети:  |   255.255.0.0    |
|    Новая маска подсети:  |   255.255.224.0  |

### Определение префиксов

Исходная маска: $$255.255.0.0 → 11111111.11111111.00000000.00000000 → /16$$

Новая маска: $$255.255.224.0 → 11111111.11111111.11100000.00000000 → /19$$

### Расчет битов подсети/узлов

Добавлено бит для подсетей: $$19-16=3$$

Бит для узлов: $$32-19=13$$

### Расчет количества подсетей/узлов

Количество подсетей: $$2^3=8$$

Количество узлов в подсети: $$2^{13}-2=8192-2=8190$$

### Расчет сетевого адреса подсети:

Выполним операцию AND для 3-го и 4-го октетов IP-адреса 172.22.32.12 и маски 255.255.224.0:

| Октет 3         | Октет 4         |
|-----------------|-----------------|
| 0 0 1 0 0 0 0 0 | 0 0 0 0 1 1 0 0 |
| 1 1 1 0 0 0 0 0 | 0 0 0 0 0 0 0 0 |
| 0 0 1 0 0 0 0 0 | 0 0 0 0 0 0 0 0 |

> Вообще, в дальнейшем в таких ситуациях можно и 4й октет не трогать, так как в маске нули)))

Адрес подсети: 172.22.32.0

### Расчет бродкаста, адресов первого и последнего узлов:

Первый IPv4-адрес узла: следующий после сетевого → 172.22.32.1

Бродкаст адрес: ---.00111111.11111111 → 172.22.63.255

Последний IPv4-адрес узла: предыдущий от бродкаста → 172.22.63.254


### Итог:

|                                         Параметр |         Значение |
| ------------------------------------------------ | ---------------- |
|                         Количество бит подсети:  |                3 |
|                  Количество созданных подсетей:  |                8 |
|                 Количество бит узлов в подсети:  |               13 |
|                     Количество узлов в подсети:  |            8190  |
|                     Сетевой адрес этой подсети:  |      172.22.32.0 |
|         IPv4-адрес первого узла в этой подсети:  |      172.22.32.1 |
|      IPv4-адрес последнего узла в этой подсети:  |    172.22.63.254 |
|    Широковещательный IPv4-адрес в этой подсети:  |    172.22.63.255 |




____________

## Задание №4

### Дано:
|                 Параметр |           Значение |
| ------------------------ | ------------------ |
|          IP-адрес узла:  |     192.168.1.245  |
| Исходная маска подсети:  |     255.255.255.0  |
|    Новая маска подсети:  |   255.255.255.252  |

### Определение префиксов

Исходная маска: $$255.255.255.0 → 11111111.11111111.11111111.00000000 → /24$$

Новая маска: $$255.255.255.252 → 11111111.11111111.11111111.11111100 → /30$$

### Расчет битов подсети/узлов

Добавлено бит для подсетей: $$30-24=6$$

Бит для узлов: $$32-30=2$$

### Расчет количества подсетей/узлов

Количество подсетей: $$2^6=64$$

Количество узлов в подсети: $$2^2-2=4-2=2$$

### Расчет сетевого адреса подсети:

Выполним операцию AND для 4-го октета IP-адреса 192.168.1.245 и маски 255.255.255.252:

| Октет 4         |
|-----------------|
| 1 1 1 1 0 1 0 1 |
| 1 1 1 1 1 1 0 0 |
| 1 1 1 1 0 1 0 0 |

Адрес подсети: 192.168.1.244/30

### Расчет бродкаста, адресов первого и последнего узлов:

Первый IPv4-адрес узла: следующий после сетевого → 192.168.1.245

Бродкаст адрес: ---.11110111 → 192.168.1.247

Последний IPv4-адрес узла: предыдущий от бродкаста → 192.168.1.246

### Итог:

|                                         Параметр |         Значение |
| ------------------------------------------------ | ---------------- |
|                         Количество бит подсети:  |                6 |
|                  Количество созданных подсетей:  |               64 |
|                 Количество бит узлов в подсети:  |                2 |
|                     Количество узлов в подсети:  |                2 |
|                     Сетевой адрес этой подсети:  | 192.168.1.244/30 |
|         IPv4-адрес первого узла в этой подсети:  |    192.168.1.245 |
|      IPv4-адрес последнего узла в этой подсети:  |    192.168.1.246 |
|    Широковещательный IPv4-адрес в этой подсети:  |    192.168.1.247 |


____________

## Задание №5

### Дано:
|                 Параметр |         Значение |
| ------------------------ | ---------------- |
|          IP-адрес узла:  |    128.107.0.55  |
| Исходная маска подсети:  |   255.255.0.0    |
|    Новая маска подсети:  |   255.255.255.0  |

### Определение префиксов

Исходная маска: $$255.255.0.0 → 11111111.11111111.00000000.00000000 → /16$$

Новая маска: $$255.255.255.0 → 11111111.11111111.11111111.00000000 → /24$$

### Расчет битов подсети/узлов

Добавлено бит для подсетей: $$24-16=8$$

Бит для узлов: $$32-24=8$$

### Расчет количества подсетей/узлов

Количество подсетей: $$2^8=256$$

Количество узлов в подсети: $$2^8-2=256-2=254$$

### Расчет сетевого адреса подсети:

Выполним операцию AND для 3-го октета IP-адреса 128.107.0.55 и маски 255.255.255.0:

| Октет 3         |
|-----------------|
| 0 0 0 0 0 0 0 0 |
| 1 1 1 1 1 1 1 1 |
| 0 0 0 0 0 0 0 0 |

Адрес подсети: 128.107.0.0/24

### Расчет бродкаста, адресов первого и последнего узлов:

Первый IPv4-адрес узла: следующий после сетевого → 128.107.0.1

Бродкаст адрес: ---.11111111 → 192.168.0.255

Последний IPv4-адрес узла: предыдущий от бродкаста → 192.168.0.254

### Итог:

|                                         Параметр |         Значение |
| ------------------------------------------------ | ---------------- |
|                         Количество бит подсети:  |                8 |
|                  Количество созданных подсетей:  |              256 |
|                 Количество бит узлов в подсети:  |                8 |
|                     Количество узлов в подсети:  |              254 |
|                     Сетевой адрес этой подсети:  |   128.107.0.0/24 |
|         IPv4-адрес первого узла в этой подсети:  |      128.107.0.1 |
|      IPv4-адрес последнего узла в этой подсети:  |    128.107.0.254 |
|    Широковещательный IPv4-адрес в этой подсети:  |    128.107.0.255 |


____________

## Задание №6

### Дано:
|                 Параметр |           Значение |
| ------------------------ | ------------------ |
|          IP-адрес узла:  |   192.135.250.180  |
| Исходная маска подсети:  |   255.255.255.0    |
|    Новая маска подсети:  |   255.255.255.248  |

### Определение префиксов

Исходная маска: $$255.255.255.0 → 11111111.11111111.11111111.00000000 → /24$$

Новая маска: $$255.255.255.248 → 11111111.11111111.11111111.11111000 → /29$$

### Расчет битов подсети/узлов

Добавлено бит для подсетей: $$29-24=5$$

Бит для узлов: $$32-29=3$$

### Расчет количества подсетей/узлов

Количество подсетей: $$2^5=32$$

Количество узлов в подсети: $$2^3-2=8-2=6$$

### Расчет сетевого адреса подсети:

Выполним операцию AND для 4-го октета IP-адреса 192.135.250.180 и маски 255.255.255.248:

| Октет 3         |
|-----------------|
| 1 0 1 1 0 1 0 0 |
| 1 1 1 1 1 0 0 0 |
| 1 0 1 1 0 0 0 0 |

Адрес подсети: 192.135.250.176/29

### Расчет бродкаста, адресов первого и последнего узлов:

Первый IPv4-адрес узла → следующий после сетевого → 192.135.250.177

Бродкаст адрес → ---.10110111 → 192.135.250.183

Последний IPv4-адрес узла → предыдущий от бродкаста → 192.135.250.182

### Итог:

|                                         Параметр |         Значение |
| ------------------------------------------------ | ---------------- |
|                         Количество бит подсети:  |                5 |
|                  Количество созданных подсетей:  |               32 |
|                 Количество бит узлов в подсети:  |                3 |
|                     Количество узлов в подсети:  |                6 |
|                     Сетевой адрес этой подсети:  |192.135.250.176/29|
|         IPv4-адрес первого узла в этой подсети:  |  192.135.250.177 |
|      IPv4-адрес последнего узла в этой подсети:  |  192.135.250.182 |
|    Широковещательный IPv4-адрес в этой подсети:  |  192.135.250.183 |

